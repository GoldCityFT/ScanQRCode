<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Line Login Pages</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Prompt', sans-serif;
    background: linear-gradient(135deg, #74ABE2, #5563DE);
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    text-align: center;
  }

  h1 {
    font-size: 6vw; /* ใช้ vw ทำให้ปรับตามหน้าจอ */
    margin-bottom: 20px;
  }

  p {
    font-size: 4vw;
    margin-bottom: 40px;
  }

  /* Modal พื้นหลัง */
  .modal {
    display: none;
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: linear-gradient(135deg, #00C300, #00A86B);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 10px; /* ให้ modal ไม่ชิดขอบหน้าจอมือถือ */
  }

  /* กล่อง modal */
  .modal-content {
    background: white;
    color: black;
    padding: 5vw; /* ใช้ vw ปรับตามหน้าจอ */
    border-radius: 10px;
    max-width: 500px;
    width: 90%; /* ให้เต็มหน้าจอมือถือแต่ไม่เกิน 500px */
    text-align: center;
  }

  /* ปุ่มยินยอม */
  .btn-agree {
    background: #00A86B;
    color: white;
    padding: 3vw 5vw;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    margin: 2vw;
    font-size: 4vw;
  }
  .btn-agree:hover { background: #007a4d; }

  /* ปุ่มไม่ยินยอม */
  .btn-decline {
    background: #ccc;
    color: black;
    padding: 3vw 5vw;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    margin: 2vw;
    font-size: 4vw;
  }
  .btn-decline:hover { background: #999; }

  /* สำหรับมือถือเท่านั้น */
@media (max-width: 767px) {
  .modal-content {
    max-width: 90%;   /* จาก 85% → 90% */
    padding: 8vw;     /* เพิ่ม padding ให้กว้างขึ้น */
  }

  .btn-agree,
  .btn-decline {
    font-size: 8vw;     /* จาก 7vw → 8vw */
    padding: 6vw 9vw;   /* ปุ่มใหญ่ขึ้น */
    margin: 4vw;
  }

  p {
    font-size: 8vw; /* ขยายข้อความใน popup */
  }
}

</style>


</head>
<body>
  <h1>ยินดีต้อนรับ! คุณลูกค้า</h1>
  <p>กำลังตรวจสอบ LINE login …</p>

  <!-- Popup Consent -->
  <div id="consentModal" class="modal">
    <div class="modal-content">
      <p>
        จำเป็นต้องใช้ LINE user ID ของคุณเพื่อเชื่อมกับ QR Code <br>
        คุณยินยอมหรือไม่?
      </p>
      <button id="agreeBtn" class="btn-agree">ยินยอม</button>
      <button id="declineBtn" class="btn-decline">ไม่ยินยอม</button>
    </div>
  </div>

  <script>
    async function main() {
      try {
        await liff.init({ liffId: "2007956346-G5BmkAQl" });

        if (!liff.isLoggedIn()) {
          liff.login(); // login ก่อน
          return;
        }

        // login แล้ว → แสดง popup
        const consentModal = document.getElementById("consentModal");
        const agreeBtn = document.getElementById("agreeBtn");
        const declineBtn = document.getElementById("declineBtn");
        consentModal.style.display = "flex";

         // กดยินยอม → แสดงหน้า index 4 วิ แล้วไป ScanQrcode.html
        agreeBtn.addEventListener("click", () => {
          consentModal.style.display = "none";
          setTimeout(() => {
            window.location.href = "ScanQrcode.html";
          }, 4000); // 4000ms = 4 วินาที
        });

        // กดไม่ยินยอม → ปิด LIFF กลับ LINE Chat
        declineBtn.addEventListener("click", () => {
          liff.closeWindow();
        });

      } catch (err) {
        console.error("LIFF init error:", err);
        alert("เกิดข้อผิดพลาด LIFF init");
      }
    }

    main();
  </script>
</body>
</html>
