<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>My LIFF Test</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body 
    {
        margin: 0;
        padding: 0;
        font-family: 'Prompt', sans-serif;
        background: linear-gradient(135deg, #00C300, #00A86B);
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        text-align: center;
    }
    h1 
    {
      font-size: 2.5rem;
      margin-bottom: 20px;
    }
    button 
    {
     background: #ffffff;
     color: #00A86B;
     border: none;
     padding: 15px 30px;
     border-radius: 50px;
     font-size: 1.2rem;
     font-weight: bold;
     cursor: pointer;
     transition: all 0.3s ease;
     margin: 10px;
     box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    button:hover 
    {
      background: #00A86B;
      color: white;
      transform: scale(1.05);
    }
    a.back-link 
    {
      color: white;
      font-weight: bold;
      text-decoration: none;
      margin-top: 20px;
      display: inline-block;
      padding: 10px 20px;
      border: 2px solid white;
      border-radius: 30px;
      transition: all 0.3s ease;
    }
    a.back-link:hover 
    {
      background: white;
      color: #00A86B;
    }

    
    /* Popup Consent */
#consentModal {
  display: none;
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
  z-index:1000;
}
#consentModalContent {
  background:white;
  color:black;
  padding:30px;
  border-radius:10px;
  max-width:400px;
  text-align:center;
}
#consentModalContent button {
  margin: 10px;
  padding: 10px 20px;
  font-size: 1rem;
  border-radius: 30px;
  border:none;
  cursor:pointer;
}
#agreeBtn { background:#00A86B; color:white; }
#declineBtn { background:#ccc; color:black; }
#agreeBtn:hover { background:#007a4d; }
#declineBtn:hover { background:#999; }  
  </style>
  
</head>
<body>
  
  <h2 id="welcome"></h2>
  <button id="gotoForm">ไปกรอกแบบสอบถาม</button>
  <button id="gotoScan">Scan QRCODE</button>
  
<!-- Popup Consent -->
<div id="consentModal">
  <div id="consentModalContent">
    <p>ทางราจะเก็บข้อมูล LINE user ID ของคุณเพื่อเชื่อมกับ QR Code <br>คุณยินยอมหรือไม่?</p>
    <button id="agreeBtn">ยินยอม</button>
    <button id="declineBtn">ไม่ยินยอม</button>
  </div>
</div>


<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      await liff.init({ liffId: "2007956346-G5BmkAQl" });

      if (!liff.isLoggedIn()) {
        liff.login();
        return;
      }

      const profile = await liff.getProfile();
      const displayName = profile.displayName;

      // แสดงชื่อผู้ใช้
      document.getElementById("welcome").innerText = "Hello, " + displayName;

      // ปุ่มไปหน้า form.html
      document.getElementById("gotoForm").addEventListener("click", () => {
        window.location.href = "Form.html";
      });
     // ปุ่ม Scan QRCODE → แสดง popup ยินยอม
    const gotoScanBtn = document.getElementById("gotoScan");
    const consentModal = document.getElementById("consentModal");
    const agreeBtn = document.getElementById("agreeBtn");
    const declineBtn = document.getElementById("declineBtn");

    gotoScanBtn.addEventListener("click", () => {
      consentModal.style.display = "flex";
    });

    agreeBtn.addEventListener("click", () => {
      // ยินยอม → ไป ScanQrcode.html
      window.location.href = "ScanQrcode.html";
    });

    declineBtn.addEventListener("click", () => {
      // ไม่ยินยอม → กลับหน้า login (reload หน้าเดิม)
      window.location.href = "Login.html";
    });

    } catch (err) {
      console.error("LIFF error:", err);
      alert("เกิดข้อผิดพลาด กรุณาลองใหม่");
    }
  });
</script>
</body>
</html>
