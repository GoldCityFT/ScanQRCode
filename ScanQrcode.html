<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>QR Scan Symmetric Frame</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  background: black;
  font-family: 'Prompt', sans-serif;
  overflow: hidden;
}

#reader {
  width: 100%;
  height: 100%;
  position: relative;
  z-index: 0;
}

/* Overlay 4 ด้านรอบกรอบ */
.overlay {
  position: absolute;
  background: rgba(0,0,0,0.5);
  z-index: 2;
}

#frame {
  position: absolute;
  border: 4px solid lime; /* กรอบด้านนอก */
  box-sizing: border-box;
  z-index: 3;
}

#message {
  position: absolute;
  bottom: 20px;
  width: 100%;
  text-align: center;
  color: white;
  font-size: 2rem;
  font-weight: bold;
  text-shadow: 0 0 5px black;
  z-index:4;
}
</style>
</head>
<body>
<div id="reader"></div>

<!-- กรอบ scan frame -->
<div id="frame"></div>

<!-- overlay ด้านนอก 4 ด้าน -->
<div id="overlay-top" class="overlay"></div>
<div id="overlay-bottom" class="overlay"></div>
<div id="overlay-left" class="overlay"></div>
<div id="overlay-right" class="overlay"></div>

<div id="message">สแกน QR Code ของคุณ</div>

<script>
function updateFrame() {
  const w = window.innerWidth;
  const h = window.innerHeight;
  const size = Math.min(w, h) * 0.6; // กรอบจัตุรัส 60% ของด้านสั้น

  // กรอบด้านนอก
  const frame = document.getElementById('frame');
  frame.style.width = size + 'px';
  frame.style.height = size + 'px';
  frame.style.left = (w - size)/2 + 'px';
  frame.style.top = (h - size)/2 + 'px';

  // overlay
  document.getElementById('overlay-top').style.top = '0px';
  document.getElementById('overlay-top').style.left = '0px';
  document.getElementById('overlay-top').style.width = w + 'px';
  document.getElementById('overlay-top').style.height = ((h - size)/2) + 'px';

  document.getElementById('overlay-bottom').style.bottom = '0px';
  document.getElementById('overlay-bottom').style.left = '0px';
  document.getElementById('overlay-bottom').style.width = w + 'px';
  document.getElementById('overlay-bottom').style.height = ((h - size)/2) + 'px';

  document.getElementById('overlay-left').style.top = ((h - size)/2) + 'px';
  document.getElementById('overlay-left').style.left = '0px';
  document.getElementById('overlay-left').style.width = ((w - size)/2) + 'px';
  document.getElementById('overlay-left').style.height = size + 'px';

  document.getElementById('overlay-right').style.top = ((h - size)/2) + 'px';
  document.getElementById('overlay-right').style.right = '0px';
  document.getElementById('overlay-right').style.width = ((w - size)/2) + 'px';
  document.getElementById('overlay-right').style.height = size + 'px';

  return size;
}

async function startScanner() {
  const html5QrCode = new Html5Qrcode("reader");
  const size = updateFrame();

  const config = { fps: 10, qrbox: { width: size, height: size } };

  html5QrCode.start(
    { facingMode: "environment" },
    config,
    qrCodeMessage => {
      alert("Scan: " + qrCodeMessage);
    },
    errorMessage => {
      console.log("Scanning...", errorMessage);
    }
  );
}

window.addEventListener('resize', updateFrame);
window.addEventListener('load', startScanner);
</script>
</body>
</html>
