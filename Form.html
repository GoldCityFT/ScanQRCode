<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>แบบสอบถามลูกค้า</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f0f0f0;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      margin: auto;
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      background: #00C300;
      border: none;
      border-radius: 5px;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover {
      background: #009f2b;
    }
  </style>
</head>
<body>
<h2>แบบสอบถาม</h2>

<form id="surveyForm" action="https://script.google.com/macros/s/AKfycbyklv9SQB7L2WdrTjHRuwZkm9UB0zime9s8v8gutC2p3VcVPQB1Pd3I8rZoQA_v63zx/exec" method="POST" target="hidden_iframe">
  <input type="hidden" name="token" value="Gl0D$Yt1@">
  <input type="hidden" id="UserId" name="UserId">

  <label>ชื่อ - นามสกุล (หรือชื่อเล่น)</label>
  <input type="text" name="DisplayName" required placeholder="ต้องระบุ">

  <label>ที่อยู่</label>
  <input type="text" name="Location" >

  <label>เบอร์โทร</label>
  <input type="number" name="Phone" required placeholder="ต้องระบุ">

  <label>Email</label>
  <input type="email" name="Mail">

  <label>สินค้าที่ซื้อล่าสุด (ถ้ามี)</label>
  <select id="itemSelect" name="ItemName">
    <option value="">-- เลือกสินค้า --</option>
    <option value="รองเท้าแตะ">รองเท้าแตะ</option>
    <option value="รองเท้าผ้าใบ">รองเท้าผ้าใบ</option>
  </select>

<label>สี (ถ้ามี)</label>
<select id="colorSelect" name="Color">
  <option value="">-- เลือกสี --</option>
</select>

  <label>ขนาด (ถ้ามี)</label>
  <select name="Size">
    <option value="">-- เลือกขนาด --</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
  </select>

  <label>Invoice (ถ้ามี)</label>
  <input type="text" name="Invoice" placeholder="เช่น INV1234">

  <button type="submit">Submit</button>
</form>

  <!-- ใช้ iframe ซ่อนการโหลดหน้าใหม่ -->
  <iframe name="hidden_iframe" style="display:none;"></iframe>
  
  <!-- popup modal -->
<div id="modal" style="
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
  z-index:1000;
">
  <div style="
    background:white;
    padding:20px;
    border-radius:10px;
    text-align:center;
    max-width:300px;
  ">
    <p>กรอกข้อมูลสำเร็จ!</p>
    <button id="okBtn">OK</button>
  </div>
</div>
</body>
  
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script> 
async function main() {
  await liff.init({ liffId: "2007956346-G5BmkAQl" });
  if (!liff.isLoggedIn()) liff.login();
  else document.getElementById("UserId").value = (await liff.getProfile()).userId;
}
main();

const form = document.getElementById("surveyForm");
const modal = document.getElementById("modal");
const okBtn = document.getElementById("okBtn");
  
form.addEventListener("submit", function() {
  const selectedItem = itemSelect.value;
  const selectedColor = colorSelect.value;

  // ถ้าเลือกสินค้าแล้ว แต่ไม่ได้เลือกสี  ห้าม submit
  if (selectedItem && !selectedColor) {
    event.preventDefault(); // หยุดการส่งฟอร์ม
    alert("กรุณาเลือกสีด้วยครับ");
    return;
  }

   // แสดง popup
  modal.style.display = "flex";
});

  okBtn.addEventListener("click", () => {
  modal.style.display = "none";   // ซ่อน popup
  window.location.href = "Login.html";
});
 // =========================================================== Filter สี รองเท้า =====================================================================
const itemSelect = document.getElementById("itemSelect");
const colorSelect = document.getElementById("colorSelect");

// กำหนดตัวเลือกสีตามสินค้า
const colorOptions = {
  "รองเท้าแตะ": ["ดำ", "ขาว"],
  "รองเท้าผ้าใบ": ["แดง", "ดำ", "ขาว", "ครีม", "เขียว", "น้ำเงิน"]
};

// ฟังก์ชันอัปเดต list สี
function updateColors() {
  const selectedItem = itemSelect.value;
  colorSelect.innerHTML = '<option value="">-- เลือกสี --</option>'; // reset

  if (selectedItem && colorOptions[selectedItem]) {
    colorOptions[selectedItem].forEach(color => {
      const option = document.createElement("option");
      option.value = color;
      option.textContent = color;
      colorSelect.appendChild(option);
    });
  }
}

// เมื่อเลือกสินค้าใหม่ → อัปเดต list สี
itemSelect.addEventListener("change", updateColors);
</script>
</html>

